<div class="bg-white rounded-lg shadow-sm p-6">
    <!-- Summary Metrics Row (matching Excel format) -->
    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
        <!-- Grand Total -->
        <div class="bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg p-4 text-white">
            <p class="text-sm opacity-90">Total</p>
            <p class="text-2xl font-bold">{{ format_currency(bid_state.grand_total) }}</p>
        </div>

        <!-- Total per Unit -->
        <div class="bg-gray-100 rounded-lg p-4">
            <p class="text-sm text-gray-600">Total/Unit</p>
            {% set unit_count = namespace(count=0) %}
            {% for item in bid_state.raw_items %}
                {% if 'unit' in item.name.lower() and 'count' in item.name.lower() %}
                    {% set unit_count.count = unit_count.count + item.qty|int %}
                {% endif %}
            {% endfor %}
            <p class="text-2xl font-bold text-gray-900">
                {% if unit_count.count > 0 %}
                    {{ format_currency(bid_state.grand_total / unit_count.count) }}
                {% else %}
                    --
                {% endif %}
            </p>
            {% if unit_count.count > 0 %}
            <p class="text-xs text-gray-500">{{ unit_count.count }} units</p>
            {% endif %}
        </div>

        <!-- $/SF -->
        <div class="bg-gray-100 rounded-lg p-4">
            <p class="text-sm text-gray-600">$/SF</p>
            {% set total_sf = namespace(sf=0) %}
            {% for item in bid_state.raw_items %}
                {% if item.uom == 'SF' %}
                    {% set total_sf.sf = total_sf.sf + item.qty %}
                {% endif %}
            {% endfor %}
            <p class="text-2xl font-bold text-gray-900">
                {% if total_sf.sf > 0 %}
                    {{ "${:,.2f}".format(bid_state.grand_total / total_sf.sf) }}
                {% else %}
                    --
                {% endif %}
            </p>
            {% if total_sf.sf > 0 %}
            <p class="text-xs text-gray-500">{{ "{:,.0f}".format(total_sf.sf) }} SF</p>
            {% endif %}
        </div>

        <!-- Total Items -->
        <div class="bg-gray-100 rounded-lg p-4">
            <p class="text-sm text-gray-600">Line Items</p>
            <p class="text-2xl font-bold text-gray-900">{{ bid_state.total_items }}</p>
            <p class="text-xs text-gray-500">{{ bid_state.section_totals|length }} sections</p>
        </div>
    </div>

    <!-- Section Breakdown -->
    <div>
        <h4 class="text-sm font-semibold text-gray-700 mb-3">Section Breakdown</h4>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
            {% for section_total in bid_state.section_totals %}
            <div class="bg-gray-50 rounded-lg p-3">
                <p class="text-xs text-gray-600 truncate">{{ section_total.section_name }}</p>
                <p class="text-lg font-semibold text-gray-900">{{ format_currency(section_total.total) }}</p>
                <p class="text-xs text-gray-500">{{ section_total.item_count }} items</p>
            </div>
            {% endfor %}
        </div>
    </div>
</div>
